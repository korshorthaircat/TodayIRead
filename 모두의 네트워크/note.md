# Chapter1 네트워크 첫걸음
* 네트워크: 컴퓨터를 두 대 이상 연결해 서로 데이터를 전송할 수 있는 통신망
* 인터넷: TCP/IP 프로토콜을 사용하는 세계 최대 규모의 네트워크
* 패킷
  * 네트워크를 통해 전송되는 데이터의 작은 조각
  * 네트워크에서 전송하는 데이터의 기본 단위
  * 큰 데이터를 그대로 보내면 그 데이터가 네트워크의 대역폭을 너무 많이 점유해 다른 패킷의 흐름을 막을 위험이 있음
    * 대역폭: 네트워크에서 이용 가능한 최대 전송 속도로 정보를 전송할 수 있는 단위 시간당 전송량
  * 송신 측에서 수신 측으로 패킷을 보낼 때 각 패킷에 순서대로 번호를 붙여 송신함

* LAN(Local Area Network, 근거리 통신망)
  * 가정이나 빌딩 사무실 등 지리적으로 제한된 곳을 범위로 한 네트워크
  * 속도가 빠르고 오류 가능성이 적다.
  * 접속 방식에는 유선 랜 방식과 무선 랜 방식이 있음

* WAN(Wide Area Network, 광역 통신망)
  * 랜을 다시 하나로 묶는 거대한 네트워크
  * 특정 도시, 국가, 대룩과 같이 매우 넓은 범위를 연결하는 네트워크
  * 속도가 느리고 오류 가능성이 높다. 
  * 인터넷 서비스 제공자(ISP, Internet Service Provider)가 제공하는 서비스를 사용하여 구축된 네트워크
     
* 인터넷 서비스 제공자(ISP, Internet Service Provider): KT, U+, SK 브로드밴드 등 인터넷 상용 서비스 사업을 하고 있는 통신 회사

* 인터넷 공유기(broadband router)
  * 가정이나 소규모 기업에서 인터넷 접속시 사용
  * 가정용으로 만든 라우터
  * 최근에는 라우터의 기능 뿐 아니라 허브, 스위칭 허브, 방화벽과 같은 다양한 기능을 제공함

* 회사에서의 랜 구성
  * DMZ(DeMilitarized Zone)
    * 외부에 공개하기 위한 네트워크
    * 네트워크 구성 중 일반적으로 인터넷인 외부 네트워크와 네트워크 사이에 위치한 중간 지대(서브넷)을 말한다.
    * 네트워크의 보안 영역으로 외부 공격자가 내부 네트워크에 침투하는 것을 막는 역할을 한다.
  * 외부에 공개하는 서버에는 주로 웹 서버, DNS 서버, 메일 서버가 있음
  * 회사의 서버는 온프레미스나 클라우드로 운영함
    * 온프레미스(on-premis): 사내 또는 데이터센터에 서버를 두고 운영하는 것
  * 각 서버나 컴퓨터는 스위치나 무선 랜 기능을 이용해 사내 랜에 접속함

* VPN(Virtual Private Network, 가상 사설망)
  * 가상 통신 터널을 만들어 기업 본사나 지사와 같은 거점간을 연결하여 통신하거나 외부에서 인터넷으로 사내에 접속함
  * VPN의 종류
    * 인터넷 VPN
      * 인터넷 VPN에는 거점 간 접속과 원격 접속 연결이 있음 (둘 다 일반 인터넷망 이용)
        * 거점간 접속: IPsec라는 암호 기술 프로토콜을 사용해 접속함
        * 원격 접속 연결: 외부에서 사용하는 컴퓨터와 사내 네트워크를 연결하므로 암호화된 통신로를 만듬
    * IP-VPN
      * MPLS라는 기술을 사용해 인터넷망이 아닌 통신 사업자 전용 폐쇄망을 사용
      * 제3자에 의한 해킹이나 데이터 변조의 위험이 없어 암호화 기능이 필요하지 않음
- - -
# Chapter2 네트워크의 기본 규칙

## OSI 모델 7계층
* 7계층 - `응용 계층(Application Layer)` - 이메일&파일 전송, 웹 사이트 조회 등 애플리케이션에 대한 서비스 제공
* 6계층 - `표현 계층(Presentation Layer)` - 문자 코드, 압축, 암호화 등의 데이터를 변환
* 5계층 - `세션 계층(Session Layer)` - 세션 체결, 통신 방식을 결정
* 4계층 - `전송 계층(Transport Layer)` - 신뢰할 수 있는 통신을 구현
* 3계층 - `네트워크 계층(Network Layer)` - 다른 네트워크와 통신하기 위한 경로 설정 및 논리 주소를 결정
* 2계층 - `데이터 링크 계층(Data Link Layer)` - 네트워크 기기간의 데이터 전송 및 물리 주소를 결정
* 1계층 - `물리 계층(Physical Layer)` - 시스템 간의 물리적 연결과 전기 신호를 변환 및 제어

* ISO(국제 표준화 기구)에서 OSI 모델을 제정함
* 송신측은 상위 계층에서 하위 계층으로 데이터를 전달하고, 수신측은 하위 계층에서 상위 계층으로 데이터를 전달 받음
  * 데이터 송신시 각 계층에서 헤더(데이터 링크 계층의 트레일러도 포함)을 붙여나가는 것을 캡슐화라 함
  * 데이터 수신시 각 계층에서 헤더(데이터 링크 계층의 트레일러도 포함)을 제거해 나가는 것을 역캡슐화라 함
* 각 계층은 독립적이므로 데이터가 전달되는 동안 다른 계층의 영향을 받지 않음
* OSI 모델 7계층을 4계층으로 바꿔 이해하는 것 = TCP/IP 모델

## TCP/IP 모델(4계층)
* 응용 계층
  * 7계층 - `응용 계층(Application Layer)` - 이메일&파일 전송, 웹 사이트 조회 등 애플리케이션에 대한 서비스 제공
  * 6계층 - `표현 계층(Presentation Layer)` - 문자 코드, 압축, 암호화 등의 데이터를 변환
  * 5계층 - `세션 계층(Session Layer)` - 세션 체결, 통신 방식을 결정
* 전송 계층
  * 4계층 - `전송 계층(Transport Layer)` - 신뢰할 수 있는 통신을 구현
* 인터넷 계층
  * 3계층 - `네트워크 계층(Network Layer)` - 다른 네트워크와 통신하기 위한 경로 설정 및 논리 주소를 결정
* 네트워크 접속 계층
  * 2계층 - `데이터 링크 계층(Data Link Layer)` - 네트워크 기기간의 데이터 전송 및 물리 주소를 결정
  * 1계층 - `물리 계층(Physical Layer)` - 시스템 간의 물리적 연결과 전기 신호를 변환 및 제어
- - -
# Chapter3 물리 계층: 데이터를 전기 신호로 변환하기

## 물리 계층의 역할과 랜 카드의 구조
* 데이터 송신 측 컴퓨터가 전송하는 0과 1의 비트열 데이터는 전기신호로 변환되어 네트워크를 통해 수신 측 컴퓨터에 도착함
* 이 때 0과 1의 정보는 컴퓨터 내부의 랜카드로 전송되고, 랜 카드가 0과 1을 전기신호로 변환함
* 컴퓨터는 내장형 랜 카드(메인보드에 포함) 혹은 별도의 랜 카드를 가지고 있음
* `물리 계층`은 컴퓨터와 네트워크 장비를 연결하고, 컴퓨터와 네트워크 장비 간 전송되는 데이터를 전기 신호로 변환하는 계층임

## 네트워크 전송 매체
* 유선
  * 트위스트 페어 케이블, 광 케이블 등
* 무선
  * 라디오파, 마이크로파, 적외선 등

### 트위스트 페어 케이블(twisted pair cable)
* 일반적으로 랜 케이블(LAN cable)이라 불림
* 랜 케이블의 양쪾에는 RJ-45라 부르는 커넥터가 붙어 있음. 이를 컴퓨터의 랜 포트나 네트워크 기기에 연결하는 것
* 종류
  * UTP(Unshielded Twist Pair) 케이블 (=비차폐 연선)
    * 구리 선 여덟 개를 두 개씩 꼬아 만든 네 쌍의 전선으로 보호(shield)되어 있지 않은 케이블
      * 실드는 금속 호일이나 금속의 매듭 같은 것으로, 외부에서 발생하는 노이즈를 막는 역할을 함
      * 노이즈의 영향을 받으면 전기 신호가 왜곡됨
    * UTP 케이블은 실드로 보호되지 않으므로 노이즈의 영향을 받기 쉽지만, 저렴하므로, 일반적으로 많이 사용됨
    * 전송 품질에 따라 규격 및 속도가 구분됨
  * STP(Shielded Twist Pair) 케이블 (=차폐 연선)
    * 노이즈의 영향을 매우 적게 받지만 비싸므로 보편적으로 사용하지는 않음
* 구분
  * 다이렉트 케이블
    * 컴퓨터와 스위치를 연결할 때 사용
    * 구리 선 여덟 개를 같은 순서로 커넥터에 연결한 테이블
  * 크로스 케이블
    * 컴퓨터 간에 직접 랜 케이블은 연결할 때 사용
    * 구리 선 여덟 개 중 한쪽 커넥터의 1번,2번에 연결된 구리선을 다른 쪽 커넥터의 3번, 6번에 연결한 케이블
      * 일부러 중간에 전선을 교차시켜 송신 측과 수신 측이 올바르게 연결되도록 함
  * 최근에는 케이블 배선 실수로 인한 통신 문제를 해결하기 위해 다이렉트 케이블과 크로스 케이블을 자동으로 판단하는 기능을 갖는 스위치나 허브를 많이 사용함 -> 따라서 컴퓨터와 허브 간 연결, 허브간 연결시 케이블 차이를 고려하지 않아도 됨

## 리피터, 허브
물리 계층의 네트워크 장비
### 리피터(repeater)
* 전기 신호를 정형(일그러진 정기 신호를 복원)하고 증폭하는 기능을 하는 네트워크 중계 장비
* 통신하는 상대방이 멀리 있을 때 리피터를 사이에 넣음
* 일대일 통신만 가능
* 요즘은 다른 네트워크 장비가 리피터 기능을 지원하므로 리피터를 사용할 필요가 없음
### 허브
* (리피터와 마찬가지로) 전기 신호를 정형하고 증폭하는 기능을 함
* 포트(실제 통신하는 통로)를 여러 개 가지고 있으며 리피터 허브라고도 불림
* 여러 개의 포트를 가지므로 컴퓨터 여러 대와 통신 가능
* 만일 허브에 5개의 컴퓨터가 연결되어 있고, 컴퓨터1이 컴퓨터2에 데이터를 보내면 컴퓨터3~5에도 데이터가 전송됨 -> 더미 허브(dummy hub)라는 이름으로 불리기도 함
* 더미 허브의 대안으로 나온 것이 스위치(switch)
- - -
# Chapter4 데이터 링크 계층: 랜에서 데이터 전송하기

* 데이터 링크 계층
  * 네트워크 장비 간 신호를 주고받는 규칙을 정하는 계층
  * 이 때 가장 일반적으로 많이 사용되는 규칙이 이더넷임
  * 랜에서 데이터를 주고받기 위해 필요한 계층

## 이더넷(Ethernet)
* 랜에서 데이터를 정상적으로 주고받기 위한 규칙
* 컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 서로 부딪칠 수 있는데 이를 충돌(collision)이라 함
* 데이터 충돌을 막기 위하여 데이터를 보내는 시점을 늦추는 규칙으로 CSMA/CD 방식을 사용
  * CSMA/CD(Carrier Sense Multiple Access with Collision Detection, 반송파 감지 다중 접속 및 충돌 탐지)
    * CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르는지 여부를 확인함
    * MA: 케이블에 데이터가 흐르지 않으면 데이터를 보내도 괜찮음
    * CD: 충돌이 발생하고 있는지 확인함
* 효율이 좋지 않으므로 요즘에는 CSMA/CD 대신 스위치를 사용

## MAC 주소(Media Access Control Address, 물리 주소)
* 랜카드(비트열(0과 1)을 전기 신호로 변환하는 장치)에는 MAC주소라는 번호가 정해져 있음
* 제조할 때 새겨지므로 물리주소라고도 불림
* 전 세계에서 유일한 번호로 할당됨
* 48비트(6바이트)의 숫자로 구성
  * 예) 00-23-AE-D9-7A-9A
  * 앞쪽 24비트는 랜카드 제조사의 번호, 뒤쪽 24비트는 제조사가 랜카드에 붙인 일련번호
### MAC 주소를 사용한 통신
* OSI 모델 중 데이터링크 계층(TCP/IP 모델 중 네트워크 접속 계층)에서 이더넷 헤더와 트레일러를 붙임
* 이더넷 헤더와 트레일러가 추가된 데이터를 **프레임**이라고 부름
  * 즉, 네트워크를 통해 프레임이 전송되는 것
#### 이더넷 헤더
* 총 14바이트로 구성됨
  * 목적지의 MAC주소(6바이트)
  * 출발지의 MAC주소(6바이트)
  * 이더넷 유형(2바이트)
    * 이더넷 유형: 전송되는 상위 계층 프로토콜을 식별하는 번호
      * 예) 유형번호-0800 / 프로토콜-IPv4
#### 트레일러
* FCS(Frame Check Sequence)라고도 불림
* 데이터 전송 도중 오류가 발생하는지 확인하는 용도로 사용

## 정리: 물리 계층, 데이터링크 계층
### 한 컴퓨터(A)에서 다른 컴퓨터(B)로 데이터를 전송할 때
* 컴퓨터(A)는,
  * 데이터링크 계층에서 데이터에 이더넷헤더, 트레일러를 추가해 프레임을 만들고, (캡슐화)
    * 이더넷 헤더에 데이터의 목적지인 컴퓨터(B)의 MAC 주소, 자신의 MAC 주소 정보를 넣음
  * 물리 계층에서 프레임 비트열을 전기신호로 변환하여,(캡슐화)
  * 네트워크를 통해 전송함
* 허브는 컴퓨터(A)가 보낸 데이터를 포트로 수신하고, 다른 모든 포트로 전송함
  * 컴퓨터(C,D,E...)는 목적지의 MAC 주소와 자신의 MAC 주소가 다르므로 데이터를 파기함
  * 컴퓨터(B)는 목적지의 MAC 주소가 자신의 MAC 주소와 같으므로 데이터를 수신함
* 컴퓨터(B)는,
  * 물리 계층에서 전기 신호로 전송된 데이터를 비트열로 변환하고, (역캡슐화)
  * 데이터링크 계층에서 이더넷헤더와 트레일러를 분리함 (역캡슐화) 
* 만일 다른 컴퓨터들이 동시에 컴퓨터(B)에 데이터를 전송하는 경우라면, 충돌을 방지하기 위해 CSMA/CD 방식이 사용됨
  * 충돌이 감지되면 다른 컴퓨터는 잠시 대기하다가 데이터를 다시 전송함

## 스위치(switch)
* 데이터링크 계층에서 동작함
* `레이어 2 스위치`, `스위칭 허브`라고 불림
* 스위치 내부에 `MAC 주소 테이블`이 존재함
  * MAC 주소 테이블
    * 브리지 테이블(bridge table)이라고도 불림
    * 스위치의 포트 번호와 해당 포트에 연결된 컴퓨터의 MAC 주소가 등록되는 데이터베이스
* `MAC 주소 학습 기능`을 지님
  * 컴퓨터에서 목적지 MAC 주소가 추가된 프레임 데이터가 전송되면 MAC 주소 테이블을 확인함
  * 출발지 MAC 주소가 등록되어 있지 않으면 MAC 주소를 포트와 함께 테이블에 등록함
* `플러딩(flooding, 홍수)`
  * 최초에 목적지 MAC주소가 MAC주소 테이블에 등록되어 있지 않은 시점에, 송신 포트 이외의 포트에 데이터(프레임)가 전송되는 현상
* `MAC 주소 필터링`
  * MAC 주소가 등록되어 있다면 목적지 컴퓨터에만 데이터가 전송됨
  * MAC 주소를 기준으로 목적지를 선택하여 불필요한 데이터를 네트워크에 전송하지 않음

## 데이터가 케이블에서 충돌하지 않는 구조
### 전이중 통신 / 반이중 통신
* 전이중 통신 방식
  * 데이터의 송수신을 동시에 통신하는 방식
  * 데이터를 동시에 통신해도 충돌이 발생하지 않음
  * 컴퓨터들을 직접 랜케이블로 연결한다면 크로스 케이블을 사용하게 되며, 전이중 통신 방식임
  * 스위치는 전이중 통신방식임 -> 최근에는 네트워크로 스위치를 사용하는 것이 표준이 됨
* 반이중 통신 방식
  * 회선 하나로 송신과 수신을 번갈아가며 통신하는 방식
  * 데이터를 동시에 통신하면 충돌이 발생함
  * 허브 내부에서는 송수신이 나누어져 있지 않기 떄문에 반이중 통신 방식임
  
### 충돌 도메인
* 데이터 전송시 충돌이 발생할 수 있는데, 충돌이 미치는 영향의 범위를 `충돌 도메인(collision domain`이라 함
* 허브는 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인이 됨(허브에 접속되어 있는 모든 컴퓨터가 충돌 도메인이 됨)
* 스위치는 충돌 도메인이 좁음
* 네트워크를 지연시키지 않기 위해 충돌 도메인의 범위를 좁히는 것이 중요함

### ARP(Address Resolution Protocol)
* 목적지 컴퓨터의 IP주소를 이용해 MAC 주소를 찾기 위한 프로토콜
* 출발지 컴퓨터가 목적지 주소를 모르면 MAC 주소를 알아내기 위해 네트워크에 브로드캐스트를 하는데, 이를 `ARP 요청`이라 함
* 요청에 대해 지정된 IP주소를 가진 컴퓨터가 MAC 주소를 응답으로 보내는 것을 `ARP 응답`이라 함
* ARP 응답을 통해 출발지 컴퓨터는 MAC 주소를 얻어내어 이더넷 프레임을 만들 수 있음
* 출발지 컴퓨터가 MAC 주소를 얻은 뒤 MAC 주소와 IP 주소의 매핑 정보를 메모리에 보관하는데, 이 정보를 `ARP 테이블`이라 함
  * 정보의 보존 기간은 ARP 캐시로 지정하여 일정 시간이 지나면 삭제 후 다시 ARP 요청을 보냄
* 윈도우 ARP 관련 명령어
  * 캐시 내용 확인시: `arp -a`
  * 캐시 강제 삭제시: `arp -d`

## 이더넷의 종류와 특징
### 이더넷 규격
* 이더넷은 케이블 종류, 통신 속도에 따라 다양한 규격으로 분류됨
  * 예) 10BASE-T
    * 10: 통신속도 10Mbps / BASE:전송방식 BASEBAND / T:케이블 종류 T

- - -
# Chapter5 네트워크 계층: 목적지에 데이터 전달하기
## 네트워크 계층의 역할
* 데이터링크 계층의 기능만으로는 해당 네트워크의 안에서만 통신이 가능함
* 네트워크 계층은 네트워크 간의 통신을 가능하게 함. 서로 다른 네트워크에 있는 목적지로 데이터를 전송하기 위해 필요

### 네트워크 계층에서의 캡슐화
* 데이터에 IP헤더를 붙임
  * IP 헤더의 내용
    * 버전, 헤더 길이, 서비스 유형, 전체 패킷 길이, ID(일련번호), 조각 상태(flags), 조각의 위치(fragment offset), TTL, 프로토콜, 헤더 체크섬, 출발지 IP 주소(32비트), 목적지 IP 주소(32비트)
* 데이터에 IP 헤더를 붙인 것을 `패킷`이라 함
  * 각 계층에서 헤더를 붙였을 때 사용하는 용어가 다름(데이터 링크 계층에서는 프레임, 네트워크 계층에서는 패킷)

### IP 주소(Internet Protocol Address)
* 데이터링크 계층에서는 데이터를 목적지까지 보내기 위해 MAC 주소가 필요하지만,
* 네트워크 계층에서는 데이터를 보내려면 IP 주소가 필요함
* IP 주소는 인터넷 서비스 제공자(ISP)에게 받을 수 있음
#### IP 주소의 버전
* IPv4
  * 32비트로 되어 있으며, IP주소를 2^32개(약 43억개) 만들 수 있음
  * 주소의 수가 고갈되고 있음.
    * 따라서 현재 인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP 주소를 할당하고, 회사나 가정의 랜에 있는 컴퓨터에는 사설 IP주소를 할당하는 정책을 사용함
* IPv6
  * 128비트로 되어 있어, IP 주소를 2^128개(약 340만 개)만들 수 있음

#### IP 주소와 MAC 주소의 비교
* MAC 주소
  * 48비트, 16진수로 표현
* IP 주소
  * 32비트
  * 8비트(1옥텟)씩 끊어서 10진수료 표현(한 마디당 0부터 255까지의 10진수 범위 가능)
#### IP 주소의 종류
* 공인 IP 주소
  * 인터넷 서비스 제공자가 제공함
  * 따라서 현재 인터넷에 직접 연결되는 컴퓨터나 라우터에는 공인 IP 주소를 할당함
* 사설 IP 주소
  * 회사나 가정의 랜에 있는 컴퓨터에는 사설 IP주소를 할당함
#### IP 주소의 구조
* 네트워크 ID, 호스트 ID 정보가 합쳐져서 IP 주소가 됨
  * 네트워크 ID
    * 어떤 네트워크인지를 나타냄
  * 호스트 ID
    * 해당 네트워크의 어느 컴퓨터이지를 나타냄
#### IP 주소의 클래스 구조
* IP 주소는 네트워크의 규모(크기)에 따라 A~E 클래스로 나누어짐
  * A 클래스
    * 대규모 네트워크 주소
    * 처음 8비트가 네트워크 ID, 나머지 24비트가 호스트 ID
    * A 클래스의 1옥텟(8비트)의 범위는 2진수 011111111까지 올 수 있으며, 이를 10진수로 변한하면 1~127이 된다.
    * 각 자리수의 IP주소 범위를 10진수로 표현하면, 1.0.0.0~127.255.255.255
  * B 클래스
    * 중형 네트워크 주소
    * 처음 16비트가 네트워크 ID, 나머지 16비트가 호스트 ID
    * B 클래스의 1옥텟의 범위는 2진수로 100000000 ~ 10111111이고, 이를 10진수로 변환하면 128~191이 된다.
    * 각 자리수의 IP주소 범위를 10진수로 표현하면, 128.0.0.0 ~ 191.255.255.255
  * C 클래스
    * 소규모 네트워크 주소
    * 처음 24비트가 네트워크 ID, 나머지 8비트가 호스트 ID
    * C 클래스의 1 옥텟 범위는 2진수로 11000000 ~ 11011111이며, 이를 10진수로 변환하면 192 ~ 223
    * 각 자리수의 IP주소 범위를 10진수로 표현하면, 192.0.0.0 ~ 223.255.255.255
  * D 클래스
    * 멀티캐스트 주소
  * E 클래스
    * 연구 및 특수용도 주소
* 일반 네트워크에서는 A~C 클래스까지 사용 가능
* 각 클래스별 사설 IP 주소의 범위
  * A 클래스
    * 10.0.0.0 ~ 10.255.255.255
  * B 클래스
    * 172.16.0.0 ~ 172.31.255.255
  * C 클래스
    * 192.168.0.0 ~ 192.168.255.255
#### 네트워크 주소 / 브로드캐스트 주소
* 네트워크 주소와 브로드캐스트 주소는 컴퓨터나 라우터가 자신의 IP로 사용할 수 없음
* 네트워크 주소: 전체 네트워크에서 작은 네트워크를 식별하는 데 사용
* 브로드캐스트 주소: 네트워크에 있는 컴퓨터나 장비 모두에게 한번에 데이터를 전송하는데 사용

#### 서브넷(subnet)
* 서브넷: 분할된 네트워크
* 서브넷팅: 네트워크를 분할하는 것
  * 기존에 `네트워크ID + 호스트ID`로 구성되던 주소를 서브넷팅하여, `네트워크ID + 서브넷ID + 호스트ID`로 변경함
  * 이 경우 대구모 네트워크를 작은 네트워크로 분할함으로써 브로드캐스트로 전송되는 패킷의 범위를 줄일 수 있고, IP주소를 더 효과적으로 관리할 수 있따.
*  서브넷 마스크
  * 네트워크ID와 호스트ID를 식별하기 위한 값

### 라우터
* 네트워크 계층을 통해 서로 다른 네트워크로 데이터를 전송하려면 `라우터(router)`라는 네트워크 장비가 필요함
* 라우터는 데이터의 목적지가 정해지면 해당 목적지까지 어떤 경로로 가는 것이 좋은지 알려주는 기능을 지님
* 라우터에는 라우팅 테이블이 있어 경로 정보를 등록하고 관리함
  * 소규모 네트워크의 경우 네트워크 관리자가 수동으로 라우팅 테이블 등록
  * 대규모 네트워크의 경우 자동으로 라우팅 테이블 등록
* 라우팅(routing)
  * 목적지 IP 주소까지 어떤 경로로 데이터를 보낼지 결정하는 것
  * 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송하는 방식
* 라우터는 네트워크를 분할할 수 있지만 스위치(레이어 2)와 허브는 네트워크를 분할할 수 없음
* 컴퓨터에서 다른 네트워크로 데이터를 전송하려면 `기본 게이트웨이`를 설정해야 함
  * '자동으로 IP 주소 받기' 설정 되어 있으면 외부 네트워크 접속시 사용되는 기본 게이트웨이가 자동으로 설정됨
* 라우팅 프로토콜: 라우터 간에 라우팅 정보를 서로 교환하기 위한 프로토콜
  * 대표적인 라우팅 프로토콜의 예: RIP, OSPE, BGP emd

- - -
# Chapter6 전송 계층: 신뢰할 수 있는 데이터 전송하기
## 전송 계층의 역할
* 물리 계층, 데이터링크 계층, 네트워크 계층이 있으면 목적지에 데이터를 보내는 것이 가능하다. 그러나 데이터가 손상되거나 유실되더라도 이에 대해 책임지지 않는다.
* 전송 계층은 목적지에 신뢰할 수 있는 데이터를 전달하기 위해 필요하다.
  * 전송 계층은 (1)오류를 점검하는 기능, (2)전송된 데이터의 목적지가 어떤 애플리케이션인지 식별하는 기능을 갖는다.
### 연결형 통신 / 비연결형 통신
* 연결형 통신
  * 신뢰할 수 있는 정확한 데이터를 전달하는 것이 우선임
  * 상대편을 확인하면서 통신
  * 예) 파일 다운로드(데이터가 늦게 도착하더라도 정확하게 전송되는 것이 중요)
  * 전송 계층의 연결형 통신 프로토콜: `TCP(Transmission Control Protocol, 전송 제어 프로토콜)`
* 비연결형 통신
  * 신뢰성과 정확성 보다는 효율적으로 데이터를 전달하는 것이 우선임
  * 상대편을 확인하지 않고 일방적으로 데이터를 전송함
  * 예) 동영상 데이터(데이터가 늦게 도착해 화면이 버벅거리는 동영상을 보는 것 보다 데이터가 약간 유실되더라도 원활하게 보는 것이 낫기 때문)
  * 전송 계층의 비연결형 통신 프로토콜: `UDP(User Datagram Protocol, 사용자 데이터그램 프로토콜)`

## TCP(Transmission Control Protocol, 전송 제어 프로토콜)
* TCP로 전송할 때 캡슐화 과정에서 붙이는 헤더를 `TCP 헤더`라고 부르며, TCP 헤더가 붙은 데이터를 `세그먼트(segment)`라고 한다.
* TCP 헤더에 포함되는 정보
  * 출발지 포트 번호(16비트), 목적지 포트 번호(16비트), 일련번호(32비트), 확인응답번호(32비트), 헤더길이(4비트), 예약영역(6비트), 코드비트(6비트), 윈도우 크기(16비트), 체크섬(16비트), 긴급 포인터(16비트), 옵션
  * 이 때, 코드비트(6비트)에는 커넥션의 제어 정보가 기록된다.
    * URG(1비트), ACK(확인응답, 1비트), PSH(1비트), RST(1비트), SYN(연결요청, 1비트), FIN(1비트)
    * `커넥션(connection)`: 연결형 통신에서 데이터를 전송하기 위해 확보하는 가상의 독점 통신로

### 3-way 핸드셰이크
* 커넥션은 SYN, ACK을 사용하여 확립한다. 
* 신뢰할 수 있는 연결을 위해 데이터를 전송하기 전에 패킷을 교환하는데, 아래와 같이 세 번 확인한다.
  * (1) 연결 확립 요청(SYN)
  * (2) 연결 확립 응답 + 연결 확립 요청(SYN, ACK)
  * (3) 연결 확립 응답(ACK)
* 이 때 코드비트의 SYN, ACK 값이 각각 1로 활성화된다.
* 데이터를 전송한 후에는 연결을 끊기 위한 요청을 교환하는데, 아래와 같이 요청을 교환한다.
  * (1) 연결 종료 요청(FIN)
  * (2) 연결 종료 응답(ACK)
  * (3) 연결 종료 요청(FIN)
  * (4) 연결 종료 응답(ACK)
* 이 때 코드비트의 FIN, ACK 값이 각각 1로 활성화된다.

### 일련번호, 확인 응답 번호
* 3-way 핸드셰이크가 끝나고 실제 데이터를 보내거나 상대방이 받을 때는, TCP 헤더의 정보 중 `일련번호(sequence number)`와 `확인응답번호(acknowledgement number)`를 사용한다.
  * 일련번호
    * 송신 측에서 수신측에 분할된 데이터가 몇 번째 데이터인지 알려주는 역할을 함
  * 확인응답번호
    * 수신 측에이 몇 번째 데이터를 수신했는지 송신 측에 알려주는 역할ㅇ르 함
    * 다음 번호의 데이터를 요청하는 데도 사용됨
* 데이터가 손상되거나 유실된 경우 데이터를 재전송할 때 사용

### 윈도우 크기
* 데이터를 주고받을 때마다 매번 확인 응답을 한 번 반환하는 통신은 효율이 낮음.
* 반면에 매번 확인 응답을 기다리지 않고, 세그먼트(데이터)를 연속적으로 보낸 뒤 확인 응답을 반환하면 효율이 높아짐
  * 수신한 세그먼트를 일시적으로 보관하는 장소인 `버퍼(buffer)`가 있기 때문에 이 방식이 가능함
* 수신 측이 세그먼트를 대량으로 받아 처리하지 못하는 경우를 `오버플로우(overflow)`라고 함
* 오버플로우가 발생하지 않도록 버퍼의 한계 크기를 알아야 함. 이를 TCP 헤더의 `윈도우 크기(window size)`라고 함
* 즉, 윈도우 크기는 얼마나 많은 용량의 데이터를 저장해둘 수 있는지를 나타냄(확인 응답을 일일이 하지 않고 연속적으로 송수신할 수 있는 데이터 크기)
* 윈도우 크기의 초기값은 3-way 핸드셰이크를 할 때 알게 됨

### 포트 번호(port number)
* TCP 헤더의 정보 중 `출발지 포트 번호(source port number)`, `목적지 포트 번호(destination port number)`를 통해 데이터의 목적지가 어떤 애플리케이션인지 구분할 수 있음
* 포트번호는 0~65535번까지 사용 가능
  * 0~1023: 잘 알려진 포트(well-known ports)
  * 1025 이상: 랜덤 포트(클라이언트 측의 송신 포트)

## UDP(User Datagram Protocol, 사용자 데이터그램 프로토콜)
* UDP는 TCP와 달리 효율성을 중시함(상대적으로 신뢰성, 정확성은 덜 중요함)
  * 따라서 상대방을 확인하지 않고 연속해서 데이터를 보냄
* UDP를 이용해 랜에 있는 컴퓨터나 네트워크 장비에 데이터를 일괄로 보내는 것을 `브로드캐스트(broadcast)`라고 함
  * TCP는 브로드캐스트처럼 불특정 다수에게 보내는 통신에 적합하지 않음(데이터 전송시 일일이 확인응답을 보내야 하므로)
### UDP 헤더
* UDP 헤더가 붙은 데이터를 `UDP 데이터그램`이라고 함
* UDP 헤더에 포함되는 정보
  * 출발지 포트번호(16비트), 목적지 포트번호(16비트), 길이(16비트), 체크섬(16비트)
